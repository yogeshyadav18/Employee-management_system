<!DOCTYPE html>
<html>
<head>
  <title>Employee Management System</title>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    input, button { margin: 5px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>Employee Management System</h1>
  <div id="login">
    <input type="password" id="password" placeholder="Admin Password" />
    <button onclick="login()">Login</button>
    <p id="login-msg"></p>
  </div>
  <div id="app" class="hidden">
    <h2>Employees</h2>
    <table border="1" cellpadding="5" id="emp-table"></table>
    <h3>Add New Employee</h3>
    <input id="name" placeholder="Name">
    <input id="email" placeholder="Email">
    <input id="position" placeholder="Position">
    <button onclick="addEmployee()">Add</button>
  </div>
  <script>
    let adminPassword = '';
    function login() {
      adminPassword = document.getElementById('password').value;
      fetch('/api/employees', { headers: { 'x-admin-password': adminPassword } })
        .then(r => r.json())
        .then(data => {
          if (Array.isArray(data)) {
            document.getElementById('login').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            loadEmployees();
          } else {
            document.getElementById('login-msg').innerText = 'Wrong password!';
          }
        });
    }
    function loadEmployees() {
      fetch('/api/employees', { headers: { 'x-admin-password': adminPassword } })
        .then(r => r.json())
        .then(showEmployees);
    }
    function showEmployees(emps) {
      let html = '<tr><th>ID</th><th>Name</th><th>Email</th><th>Position</th><th>Actions</th></tr>';
      emps.forEach(emp => {
        html += `<tr>
          <td>${emp.id}</td>
          <td><input value="${emp.name}" id="name${emp.id}"></td>
          <td><input value="${emp.email}" id="email${emp.id}"></td>
          <td><input value="${emp.position}" id="position${emp.id}"></td>
          <td>
            <button onclick="updateEmployee(${emp.id})">Update</button>
            <button onclick="deleteEmployee(${emp.id})">Delete</button>
          </td>
        </tr>`;
      });
      document.getElementById('emp-table').innerHTML = html;
    }
    function addEmployee() {
      fetch('/api/employees', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-admin-password': adminPassword
        },
        body: JSON.stringify({
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          position: document.getElementById('position').value
        })
      }).then(loadEmployees);
    }
    function updateEmployee(id) {
      fetch('/api/employees/' + id, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'x-admin-password': adminPassword
        },
        body: JSON.stringify({
          name: document.getElementById('name' + id).value,
          email: document.getElementById('email' + id).value,
          position: document.getElementById('position' + id).value
        })
      }).then(loadEmployees);
    }
    function deleteEmployee(id) {
      fetch('/api/employees/' + id, {
        method: 'DELETE',
        headers: { 'x-admin-password': adminPassword }
      }).then(loadEmployees);
    }
  </script>
</body>
</html>
